# 编码与封装格式

## 本文大部分参考了
~~http://vcb-s.com/archives/2726~~

封装格式(MP4/MKV…)、编码格式(H.264/FLAC/AAC…) etc

容器(封装格式)，H.264/FLAC/AAC属于编码方式，也就是MP4以及MKV上可以使用相同的编码方式

对于音频

注：flac-Free Lossless Audio
 Codec-自由无损音频压缩编码，flac也是常见的无损音频文件格式(flac也用同样的名字做了容器名(即同时是封装格式的名字),<https://developer.mozilla.org/zh-TW/docs/Web/Media/Formats/Containers>)，而ape属于无损音频文件格式，但其并不代表编码方式。又比如m4a(封装格式,仅有音频的MPEG-4文件会使用.m4a扩展名)可以使用ALAC(Apple Lossless Audio Codec)编码也可以使用AAC(Advanced Audio Coding)编码。

另外MP3(formally MPEG-1 Audio Layer III or MPEG-2 Audio Layer III) 是由MPEG-1封装容器与一个以MPEG-1Audio Layer III encoding编码过的音轨所组成。

WAV属于封装格式，封装的PCM属于原始音频数据，完全未经压缩的编码方式，脉冲编码调制（Pulse Code Modulation, PCM）是一种模拟信号的数字化方法。它是最常用、最简单的波形编码方式。

一些需要注意的

H.265/HEVC 是编码

x265是开源免费编码器，另外还有一些商业的编码器，例如[视骏](http://www.strongene.com/),[NVENC](https://www.nvidia.com/en-us/geforce/guides/broadcasting-guide/)


## 封装格式
比较常见的MP4，MKV，RMVB，TS，FLV，AVI等很多，各种封装格式支持的编码是不一样的。


MKV vs MP4，主要的区别在于：

1. MKV支持封装FLAC作为音频，MP4则不支持。但是MP4也可以封装无损音轨(比如说ALAC，虽然普遍认为ALAC的效率不如FLAC优秀)
2. MKV支持封装ASS/SSA格式的字幕，MP4则不支持。一般字幕组制作的字幕是ASS格式，所以内封字幕多见于MKV格式
3. MP4作为工业标准，在视频编辑软件和播放设备上的兼容性一般好于MKV。这也是vcb-s那些为移动设备优化的视频基本上选择MP4封装的原因。

还有一些过时的封装格式，比如RM、AVI等等。



# 编码格式
通常，mediainfo需要封装格式才能显示比较完整的信息，如.pcm .aac .hevc不能显示时长等信息。.hevc在播放器中是无法使用进度条的。

LPCM(Linear pulse-code modulation) 一般也会叫PCM，但是一种特定类型的 PCM，其跟PCM(Pulse Code Modulation)有区别，其量化级别是线性均匀的。


## 无损压缩以及有损压缩
首先PCM和LPCM属于未经压缩的格式，不称为无损压缩。

日常中的无损较为口语化，需要理解其意思。通常说的无损格式指的算法无损，并不意味着生成的文件必定无损，一些音轨降位深或降频会造成损失。也会有一些有损转无损的非常规操作。

通常说原盘以及Remux无损，原盘一般是能找到的最优质的源，但其编码格式都属于有损，从母带(口语化)出来进行有损压缩再发布。而Remux主要为视频轨道以及主要音频轨道的无损提取或转换。(不过会有Hybird)